{"version":3,"sources":["casa_financas/subs.cljs"],"mappings":"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","names":["re_frame.core.reg_sub","db","_","casa-financas.subs/mes-estritamente-anterior?","ano","mes","ano-ref","mes-ref","cljs.core._EQ_","p__25848","vec__25849","cljs.core.nth","despesas","cljs.core.filter","d","p__25853","vec__25854","entradas","e","parts","clojure.string.split","cljs.core/first","m","cljs.core/second","cljs.core.reduce","cljs.core/+","cljs.core.map","p__25862","vec__25863","desp-ant","p1__25860#","entr-ant","total-entr","total-desp","p__25868","vec__25869","pessoa-id","p1__25866#","p1__25867#","debitos","pct","cljs.core.get","cljs.core.keyword","p__25874","vec__25876","configs","G__25881","p1__25886#","p__25890","vec__25891","fatura","pago-pix","p1__25888#","and__5140__auto__","cljs.core.not_EQ_","pago-fatura","or__5142__auto__"],"sourcesContent":["(ns casa-financas.subs\n  (:require [re-frame.core :as rf]))\n\n(rf/reg-sub :aba-ativa     (fn [db _] (:aba-ativa db)))\n(rf/reg-sub :mes-atual     (fn [db _] (:mes-atual db)))\n(rf/reg-sub :usuario-atual (fn [db _] (:usuario-atual db)))\n(rf/reg-sub :pessoa-ativa  (fn [db _] (:pessoa-ativa db)))\n(rf/reg-sub :modal         (fn [db _] (:modal db)))\n(rf/reg-sub :loading       (fn [db _] (:loading db)))\n(rf/reg-sub :erro          (fn [db _] (:erro db)))\n(rf/reg-sub :despesas      (fn [db _] (:despesas db)))\n(rf/reg-sub :entradas      (fn [db _] (:entradas db)))\n(rf/reg-sub :templates     (fn [db _] (:templates db)))\n(rf/reg-sub :categorias    (fn [db _] (:categorias db)))\n(rf/reg-sub :despesas-historico (fn [db _] (:despesas-historico db)))\n(rf/reg-sub :entradas-historico (fn [db _] (:entradas-historico db)))\n\n(defn mes-estritamente-anterior? [ano mes ano-ref mes-ref]\n  (or (< ano ano-ref)\n      (and (= ano ano-ref) (< mes mes-ref))))\n\n(rf/reg-sub\n :despesas-do-mes\n :<- [:despesas]\n :<- [:mes-atual]\n (fn [[despesas mes] _]\n   (filter (fn [d]\n             (and (= (:ano d) (:ano mes))\n                  (= (:mes d) (:mes mes))))\n           despesas)))\n\n(rf/reg-sub\n :entradas-do-mes\n :<- [:entradas]\n :<- [:mes-atual]\n (fn [[entradas mes] _]\n   (filter (fn [e]\n             (when (:data e)\n               (let [parts (clojure.string/split (:data e) #\"-\")\n                     ano   (int (first parts))\n                     m     (int (second parts))]\n                 (and (= ano (:ano mes))\n                      (= m (:mes mes))))))\n           entradas)))\n\n(rf/reg-sub\n :total-previsto-mes\n :<- [:despesas-do-mes]\n (fn [despesas _]\n   (reduce + 0 (map :valor despesas))))\n\n(rf/reg-sub\n :total-entradas-mes\n :<- [:entradas-do-mes]\n (fn [entradas _]\n   (reduce + 0 (map :valor entradas))))\n\n(rf/reg-sub\n :saldo-acumulado-anterior\n :<- [:despesas-historico]\n :<- [:entradas-historico]\n :<- [:mes-atual]\n (fn [[despesas entradas mes] _]\n   (let [desp-ant (filter #(mes-estritamente-anterior?\n                             (:ano %) (:mes %)\n                             (:ano mes) (:mes mes))\n                          despesas)\n         entr-ant (filter (fn [e]\n                            (when (:data e)\n                              (let [parts (clojure.string/split (:data e) #\"-\")\n                                    ano   (int (first parts))\n                                    m     (int (second parts))]\n                                (mes-estritamente-anterior?\n                                  ano m (:ano mes) (:mes mes)))))\n                          entradas)\n         total-entr (reduce + 0 (map :valor entr-ant))\n         total-desp (reduce + 0 (map :valor desp-ant))]\n     (- total-entr total-desp))))\n\n(rf/reg-sub\n :saldo-acumulado-anterior-pessoa\n (fn [db [_ pessoa-id]]\n   (let [mes      (:mes-atual db)\n         despesas (filter #(mes-estritamente-anterior?\n                            (:ano %) (:mes %)\n                            (:ano mes) (:mes mes))\n                          (:despesas-historico db))\n         entradas (filter (fn [e]\n                            (when (:data e)\n                              (let [parts (clojure.string/split (:data e) #\"-\")\n                                    ano   (int (first parts))\n                                    m     (int (second parts))]\n                                (mes-estritamente-anterior?\n                                 ano m (:ano mes) (:mes mes)))))\n                          (:entradas-historico db))\n         total-entr (reduce + 0\n                            (map :valor\n                                 (filter #(= (:pessoa_id %) pessoa-id) entradas)))\n         debitos    (reduce + 0\n                            (map (fn [d]\n                                   (let [pct (get (:divisao d) (keyword pessoa-id) 0)]\n                                     (* (:valor d) (/ pct 100))))\n                                 despesas))]\n     (- total-entr debitos))))\n\n(rf/reg-sub\n :configuracoes\n (fn [db _]\n   (:configuracoes db)))\n\n(rf/reg-sub\n :cor-pessoa\n :<- [:configuracoes]\n (fn [configs [_ pessoa-id]]\n   (get configs (str \"cor_\" pessoa-id)\n        (case pessoa-id\n          \"andre\"    \"#3B82F6\"\n          \"bianca\"   \"#EC4899\"\n          \"fernanda\" \"#14B8A6\"\n          \"bruna\"    \"#F97316\"\n          \"#9CA3AF\"))))\n\n(rf/reg-sub :fatura (fn [db _] (:fatura db)))\n\n(rf/reg-sub\n :total-credito-mes\n :<- [:despesas-do-mes]\n (fn [despesas _]\n   (reduce + 0 (map :valor (filter #(= (:forma_pagamento %) \"credito\") despesas)))))\n\n(rf/reg-sub\n :total-pago-mes\n :<- [:despesas-do-mes]\n :<- [:fatura]\n (fn [[despesas fatura] _]\n   (let [pago-pix (reduce + 0 (map :valor (filter #(and (:pago %) (not= (:forma_pagamento %) \"credito\")) despesas)))\n         pago-fatura (or (:valor_pago fatura) 0)]\n     (+ pago-pix pago-fatura))))"]}