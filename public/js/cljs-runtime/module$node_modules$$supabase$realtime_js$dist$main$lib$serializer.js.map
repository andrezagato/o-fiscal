{
"version":3,
"file":"module$node_modules$$supabase$realtime_js$dist$main$lib$serializer.js",
"lineCount":116,
"mappings":"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",
"sources":["node_modules/@supabase/realtime-js/dist/main/lib/serializer.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$supabase$realtime_js$dist$main$lib$serializer\"] = function(require,module,exports) {\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Serializer {\n    constructor(allowedMetadataKeys) {\n        this.HEADER_LENGTH = 1;\n        this.USER_BROADCAST_PUSH_META_LENGTH = 6;\n        this.KINDS = { userBroadcastPush: 3, userBroadcast: 4 };\n        this.BINARY_ENCODING = 0;\n        this.JSON_ENCODING = 1;\n        this.BROADCAST_EVENT = 'broadcast';\n        this.allowedMetadataKeys = [];\n        this.allowedMetadataKeys = allowedMetadataKeys !== null && allowedMetadataKeys !== void 0 ? allowedMetadataKeys : [];\n    }\n    encode(msg, callback) {\n        if (msg.event === this.BROADCAST_EVENT &&\n            !(msg.payload instanceof ArrayBuffer) &&\n            typeof msg.payload.event === 'string') {\n            return callback(this._binaryEncodeUserBroadcastPush(msg));\n        }\n        let payload = [msg.join_ref, msg.ref, msg.topic, msg.event, msg.payload];\n        return callback(JSON.stringify(payload));\n    }\n    _binaryEncodeUserBroadcastPush(message) {\n        var _a;\n        if (this._isArrayBuffer((_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload)) {\n            return this._encodeBinaryUserBroadcastPush(message);\n        }\n        else {\n            return this._encodeJsonUserBroadcastPush(message);\n        }\n    }\n    _encodeBinaryUserBroadcastPush(message) {\n        var _a, _b;\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : new ArrayBuffer(0);\n        return this._encodeUserBroadcastPush(message, this.BINARY_ENCODING, userPayload);\n    }\n    _encodeJsonUserBroadcastPush(message) {\n        var _a, _b;\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : {};\n        const encoder = new TextEncoder();\n        const encodedUserPayload = encoder.encode(JSON.stringify(userPayload)).buffer;\n        return this._encodeUserBroadcastPush(message, this.JSON_ENCODING, encodedUserPayload);\n    }\n    _encodeUserBroadcastPush(message, encodingType, encodedPayload) {\n        var _a, _b;\n        const topic = message.topic;\n        const ref = (_a = message.ref) !== null && _a !== void 0 ? _a : '';\n        const joinRef = (_b = message.join_ref) !== null && _b !== void 0 ? _b : '';\n        const userEvent = message.payload.event;\n        // Filter metadata based on allowed keys\n        const rest = this.allowedMetadataKeys\n            ? this._pick(message.payload, this.allowedMetadataKeys)\n            : {};\n        const metadata = Object.keys(rest).length === 0 ? '' : JSON.stringify(rest);\n        // Validate lengths don't exceed uint8 max value (255)\n        if (joinRef.length > 255) {\n            throw new Error(`joinRef length ${joinRef.length} exceeds maximum of 255`);\n        }\n        if (ref.length > 255) {\n            throw new Error(`ref length ${ref.length} exceeds maximum of 255`);\n        }\n        if (topic.length > 255) {\n            throw new Error(`topic length ${topic.length} exceeds maximum of 255`);\n        }\n        if (userEvent.length > 255) {\n            throw new Error(`userEvent length ${userEvent.length} exceeds maximum of 255`);\n        }\n        if (metadata.length > 255) {\n            throw new Error(`metadata length ${metadata.length} exceeds maximum of 255`);\n        }\n        const metaLength = this.USER_BROADCAST_PUSH_META_LENGTH +\n            joinRef.length +\n            ref.length +\n            topic.length +\n            userEvent.length +\n            metadata.length;\n        const header = new ArrayBuffer(this.HEADER_LENGTH + metaLength);\n        let view = new DataView(header);\n        let offset = 0;\n        view.setUint8(offset++, this.KINDS.userBroadcastPush); // kind\n        view.setUint8(offset++, joinRef.length);\n        view.setUint8(offset++, ref.length);\n        view.setUint8(offset++, topic.length);\n        view.setUint8(offset++, userEvent.length);\n        view.setUint8(offset++, metadata.length);\n        view.setUint8(offset++, encodingType);\n        Array.from(joinRef, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(ref, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(topic, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(userEvent, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(metadata, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        var combined = new Uint8Array(header.byteLength + encodedPayload.byteLength);\n        combined.set(new Uint8Array(header), 0);\n        combined.set(new Uint8Array(encodedPayload), header.byteLength);\n        return combined.buffer;\n    }\n    decode(rawPayload, callback) {\n        if (this._isArrayBuffer(rawPayload)) {\n            let result = this._binaryDecode(rawPayload);\n            return callback(result);\n        }\n        if (typeof rawPayload === 'string') {\n            const jsonPayload = JSON.parse(rawPayload);\n            const [join_ref, ref, topic, event, payload] = jsonPayload;\n            return callback({ join_ref, ref, topic, event, payload });\n        }\n        return callback({});\n    }\n    _binaryDecode(buffer) {\n        const view = new DataView(buffer);\n        const kind = view.getUint8(0);\n        const decoder = new TextDecoder();\n        switch (kind) {\n            case this.KINDS.userBroadcast:\n                return this._decodeUserBroadcast(buffer, view, decoder);\n        }\n    }\n    _decodeUserBroadcast(buffer, view, decoder) {\n        const topicSize = view.getUint8(1);\n        const userEventSize = view.getUint8(2);\n        const metadataSize = view.getUint8(3);\n        const payloadEncoding = view.getUint8(4);\n        let offset = this.HEADER_LENGTH + 4;\n        const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\n        offset = offset + topicSize;\n        const userEvent = decoder.decode(buffer.slice(offset, offset + userEventSize));\n        offset = offset + userEventSize;\n        const metadata = decoder.decode(buffer.slice(offset, offset + metadataSize));\n        offset = offset + metadataSize;\n        const payload = buffer.slice(offset, buffer.byteLength);\n        const parsedPayload = payloadEncoding === this.JSON_ENCODING ? JSON.parse(decoder.decode(payload)) : payload;\n        const data = {\n            type: this.BROADCAST_EVENT,\n            event: userEvent,\n            payload: parsedPayload,\n        };\n        // Metadata is optional and always JSON encoded\n        if (metadataSize > 0) {\n            data['meta'] = JSON.parse(metadata);\n        }\n        return { join_ref: null, ref: null, topic: topic, event: this.BROADCAST_EVENT, payload: data };\n    }\n    _isArrayBuffer(buffer) {\n        var _a;\n        return buffer instanceof ArrayBuffer || ((_a = buffer === null || buffer === void 0 ? void 0 : buffer.constructor) === null || _a === void 0 ? void 0 : _a.name) === 'ArrayBuffer';\n    }\n    _pick(obj, keys) {\n        if (!obj || typeof obj !== 'object') {\n            return {};\n        }\n        return Object.fromEntries(Object.entries(obj).filter(([key]) => keys.includes(key)));\n    }\n}\nexports.default = Serializer;\n//# sourceMappingURL=serializer.js.map\n};"],
"names":["shadow$provide","require","module","exports","Object","defineProperty","value","Serializer","constructor","allowedMetadataKeys","HEADER_LENGTH","USER_BROADCAST_PUSH_META_LENGTH","KINDS","userBroadcastPush","userBroadcast","BINARY_ENCODING","JSON_ENCODING","BROADCAST_EVENT","encode","msg","callback","event","payload","ArrayBuffer","JSON","stringify","join_ref","ref","topic","_binaryEncodeUserBroadcastPush","message","_a","_isArrayBuffer","_encodeBinaryUserBroadcastPush","_encodeJsonUserBroadcastPush","_b","userPayload","_encodeUserBroadcastPush","encodedUserPayload","encoder","TextEncoder","buffer","encodingType","encodedPayload","joinRef","userEvent","rest","_pick","metadata","keys","length","Error","header","view","DataView","offset","setUint8","Array","from","char","charCodeAt","combined","Uint8Array","byteLength","set","decode","rawPayload","result","_binaryDecode","jsonPayload","parse","kind","getUint8","decoder","TextDecoder","_decodeUserBroadcast","topicSize","userEventSize","metadataSize","payloadEncoding","slice","parsedPayload","data","type","name","obj","fromEntries","entries","filter","key","includes","default"]
}
