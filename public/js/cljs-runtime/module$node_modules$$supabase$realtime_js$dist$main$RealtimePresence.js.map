{
"version":3,
"file":"module$node_modules$$supabase$realtime_js$dist$main$RealtimePresence.js",
"lineCount":128,
"mappings":"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",
"sources":["node_modules/@supabase/realtime-js/dist/main/RealtimePresence.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$supabase$realtime_js$dist$main$RealtimePresence\"] = function(require,module,exports) {\n\"use strict\";\r\n/*\r\n  This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\r\n  License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\r\n*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.REALTIME_PRESENCE_LISTEN_EVENTS = void 0;\r\nvar REALTIME_PRESENCE_LISTEN_EVENTS;\r\n(function (REALTIME_PRESENCE_LISTEN_EVENTS) {\r\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"SYNC\"] = \"sync\";\r\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"JOIN\"] = \"join\";\r\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"LEAVE\"] = \"leave\";\r\n})(REALTIME_PRESENCE_LISTEN_EVENTS || (exports.REALTIME_PRESENCE_LISTEN_EVENTS = REALTIME_PRESENCE_LISTEN_EVENTS = {}));\r\nclass RealtimePresence {\r\n    /**\r\n     * Creates a Presence helper that keeps the local presence state in sync with the server.\r\n     *\r\n     * @param channel - The realtime channel to bind to.\r\n     * @param opts - Optional custom event names, e.g. `{ events: { state: 'state', diff: 'diff' } }`.\r\n     *\r\n     * @example\r\n     * ```ts\r\n     * const presence = new RealtimePresence(channel)\r\n     *\r\n     * channel.on('presence', ({ event, key }) => {\r\n     *   console.log(`Presence ${event} on ${key}`)\r\n     * })\r\n     * ```\r\n     */\r\n    constructor(channel, opts) {\r\n        this.channel = channel;\r\n        this.state = {};\r\n        this.pendingDiffs = [];\r\n        this.joinRef = null;\r\n        this.enabled = false;\r\n        this.caller = {\r\n            onJoin: () => { },\r\n            onLeave: () => { },\r\n            onSync: () => { },\r\n        };\r\n        const events = (opts === null || opts === void 0 ? void 0 : opts.events) || {\r\n            state: 'presence_state',\r\n            diff: 'presence_diff',\r\n        };\r\n        this.channel._on(events.state, {}, (newState) => {\r\n            const { onJoin, onLeave, onSync } = this.caller;\r\n            this.joinRef = this.channel._joinRef();\r\n            this.state = RealtimePresence.syncState(this.state, newState, onJoin, onLeave);\r\n            this.pendingDiffs.forEach((diff) => {\r\n                this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\r\n            });\r\n            this.pendingDiffs = [];\r\n            onSync();\r\n        });\r\n        this.channel._on(events.diff, {}, (diff) => {\r\n            const { onJoin, onLeave, onSync } = this.caller;\r\n            if (this.inPendingSyncState()) {\r\n                this.pendingDiffs.push(diff);\r\n            }\r\n            else {\r\n                this.state = RealtimePresence.syncDiff(this.state, diff, onJoin, onLeave);\r\n                onSync();\r\n            }\r\n        });\r\n        this.onJoin((key, currentPresences, newPresences) => {\r\n            this.channel._trigger('presence', {\r\n                event: 'join',\r\n                key,\r\n                currentPresences,\r\n                newPresences,\r\n            });\r\n        });\r\n        this.onLeave((key, currentPresences, leftPresences) => {\r\n            this.channel._trigger('presence', {\r\n                event: 'leave',\r\n                key,\r\n                currentPresences,\r\n                leftPresences,\r\n            });\r\n        });\r\n        this.onSync(() => {\r\n            this.channel._trigger('presence', { event: 'sync' });\r\n        });\r\n    }\r\n    /**\r\n     * Used to sync the list of presences on the server with the\r\n     * client's state.\r\n     *\r\n     * An optional `onJoin` and `onLeave` callback can be provided to\r\n     * react to changes in the client's local presences across\r\n     * disconnects and reconnects with the server.\r\n     *\r\n     * @internal\r\n     */\r\n    static syncState(currentState, newState, onJoin, onLeave) {\r\n        const state = this.cloneDeep(currentState);\r\n        const transformedState = this.transformState(newState);\r\n        const joins = {};\r\n        const leaves = {};\r\n        this.map(state, (key, presences) => {\r\n            if (!transformedState[key]) {\r\n                leaves[key] = presences;\r\n            }\r\n        });\r\n        this.map(transformedState, (key, newPresences) => {\r\n            const currentPresences = state[key];\r\n            if (currentPresences) {\r\n                const newPresenceRefs = newPresences.map((m) => m.presence_ref);\r\n                const curPresenceRefs = currentPresences.map((m) => m.presence_ref);\r\n                const joinedPresences = newPresences.filter((m) => curPresenceRefs.indexOf(m.presence_ref) < 0);\r\n                const leftPresences = currentPresences.filter((m) => newPresenceRefs.indexOf(m.presence_ref) < 0);\r\n                if (joinedPresences.length > 0) {\r\n                    joins[key] = joinedPresences;\r\n                }\r\n                if (leftPresences.length > 0) {\r\n                    leaves[key] = leftPresences;\r\n                }\r\n            }\r\n            else {\r\n                joins[key] = newPresences;\r\n            }\r\n        });\r\n        return this.syncDiff(state, { joins, leaves }, onJoin, onLeave);\r\n    }\r\n    /**\r\n     * Used to sync a diff of presence join and leave events from the\r\n     * server, as they happen.\r\n     *\r\n     * Like `syncState`, `syncDiff` accepts optional `onJoin` and\r\n     * `onLeave` callbacks to react to a user joining or leaving from a\r\n     * device.\r\n     *\r\n     * @internal\r\n     */\r\n    static syncDiff(state, diff, onJoin, onLeave) {\r\n        const { joins, leaves } = {\r\n            joins: this.transformState(diff.joins),\r\n            leaves: this.transformState(diff.leaves),\r\n        };\r\n        if (!onJoin) {\r\n            onJoin = () => { };\r\n        }\r\n        if (!onLeave) {\r\n            onLeave = () => { };\r\n        }\r\n        this.map(joins, (key, newPresences) => {\r\n            var _a;\r\n            const currentPresences = (_a = state[key]) !== null && _a !== void 0 ? _a : [];\r\n            state[key] = this.cloneDeep(newPresences);\r\n            if (currentPresences.length > 0) {\r\n                const joinedPresenceRefs = state[key].map((m) => m.presence_ref);\r\n                const curPresences = currentPresences.filter((m) => joinedPresenceRefs.indexOf(m.presence_ref) < 0);\r\n                state[key].unshift(...curPresences);\r\n            }\r\n            onJoin(key, currentPresences, newPresences);\r\n        });\r\n        this.map(leaves, (key, leftPresences) => {\r\n            let currentPresences = state[key];\r\n            if (!currentPresences)\r\n                return;\r\n            const presenceRefsToRemove = leftPresences.map((m) => m.presence_ref);\r\n            currentPresences = currentPresences.filter((m) => presenceRefsToRemove.indexOf(m.presence_ref) < 0);\r\n            state[key] = currentPresences;\r\n            onLeave(key, currentPresences, leftPresences);\r\n            if (currentPresences.length === 0)\r\n                delete state[key];\r\n        });\r\n        return state;\r\n    }\r\n    /** @internal */\r\n    static map(obj, func) {\r\n        return Object.getOwnPropertyNames(obj).map((key) => func(key, obj[key]));\r\n    }\r\n    /**\r\n     * Remove 'metas' key\r\n     * Change 'phx_ref' to 'presence_ref'\r\n     * Remove 'phx_ref' and 'phx_ref_prev'\r\n     *\r\n     * @example\r\n     * // returns {\r\n     *  abc123: [\r\n     *    { presence_ref: '2', user_id: 1 },\r\n     *    { presence_ref: '3', user_id: 2 }\r\n     *  ]\r\n     * }\r\n     * RealtimePresence.transformState({\r\n     *  abc123: {\r\n     *    metas: [\r\n     *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\r\n     *      { phx_ref: '3', user_id: 2 }\r\n     *    ]\r\n     *  }\r\n     * })\r\n     *\r\n     * @internal\r\n     */\r\n    static transformState(state) {\r\n        state = this.cloneDeep(state);\r\n        return Object.getOwnPropertyNames(state).reduce((newState, key) => {\r\n            const presences = state[key];\r\n            if ('metas' in presences) {\r\n                newState[key] = presences.metas.map((presence) => {\r\n                    presence['presence_ref'] = presence['phx_ref'];\r\n                    delete presence['phx_ref'];\r\n                    delete presence['phx_ref_prev'];\r\n                    return presence;\r\n                });\r\n            }\r\n            else {\r\n                newState[key] = presences;\r\n            }\r\n            return newState;\r\n        }, {});\r\n    }\r\n    /** @internal */\r\n    static cloneDeep(obj) {\r\n        return JSON.parse(JSON.stringify(obj));\r\n    }\r\n    /** @internal */\r\n    onJoin(callback) {\r\n        this.caller.onJoin = callback;\r\n    }\r\n    /** @internal */\r\n    onLeave(callback) {\r\n        this.caller.onLeave = callback;\r\n    }\r\n    /** @internal */\r\n    onSync(callback) {\r\n        this.caller.onSync = callback;\r\n    }\r\n    /** @internal */\r\n    inPendingSyncState() {\r\n        return !this.joinRef || this.joinRef !== this.channel._joinRef();\r\n    }\r\n}\r\nexports.default = RealtimePresence;\r\n//# sourceMappingURL=RealtimePresence.js.map\n};"],
"names":["shadow$provide","require","module","exports","Object","defineProperty","value","REALTIME_PRESENCE_LISTEN_EVENTS","RealtimePresence","constructor","channel","opts","state","pendingDiffs","joinRef","enabled","caller","onJoin","onLeave","onSync","events","diff","_on","newState","_joinRef","syncState","forEach","syncDiff","inPendingSyncState","push","key","currentPresences","newPresences","_trigger","event","leftPresences","currentState","cloneDeep","transformedState","transformState","joins","leaves","map","presences","newPresenceRefs","m","presence_ref","curPresenceRefs","joinedPresences","filter","indexOf","length","_a","joinedPresenceRefs","curPresences","unshift","presenceRefsToRemove","obj","func","getOwnPropertyNames","reduce","metas","presence","JSON","parse","stringify","callback","default"]
}
