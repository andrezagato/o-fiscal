{"version":3,"sources":["casa_financas/views/entradas.cljs"],"mappings":"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","names":["casa-financas.views.entradas/formatar-data-curta","data-str","d","js/Date","dia","mes","casa-financas.views.entradas/item-entrada","entrada","cor","casa-financas.utils/pessoa-cor","re-frame.core/dispatch","casa-financas.components.comum/avatar","casa-financas.utils/pessoa-nome","and__5140__auto__","cljs.core.not_EQ_","casa-financas.utils/formatar-valor-br","casa-financas.views.entradas/entradas","cljs.core/deref","entradas-mes","re_frame.core.subscribe","total","divisao-barr","cljs.core.reduce","acc","e","pid","cljs.core.keyword","pct","p1__26592#","cljs.core.update","or__5142__auto__","casa-financas.components.comum/seletor-mes","casa-financas.components.comum/barra-divisao","cljs.core/empty?","iter__5628__auto__","s__26604","cljs.core/LazySeq","temp__5823__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5626__auto__","size__5627__auto__","cljs.core/count","b__26606","cljs.core/chunk-buffer","i__26605","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__26603","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","cljs.core.sort_by","cljs.core/chunk-first"],"sourcesContent":["(ns casa-financas.views.entradas\n  (:require [re-frame.core :as rf]\n            [casa-financas.utils :as u]\n            [casa-financas.components.comum :as c]))\n\n(defn formatar-data-curta [data-str]\n  (when data-str\n    (let [d (js/Date. data-str)\n          dia (.getDate d)\n          mes (inc (.getMonth d))]\n      (str (when (< dia 10) \"0\") dia \"/\" (when (< mes 10) \"0\") mes))))\n\n(defn item-entrada [entrada]\n  (let [cor (u/pessoa-cor (:pessoa_id entrada))]\n    [:div {:class    \"rounded-xl p-3 mb-2 border\"\n           :style    {:background-color (str cor \"15\")\n                      :border-color     (str cor \"40\")}\n           :on-click #(rf/dispatch [:abrir-modal :editar-entrada entrada])}\n     [:div {:class \"flex items-center gap-3\"}\n      [c/avatar (:pessoa_id entrada) {:size \"sm\"}]\n      [:div {:class \"flex-1 min-w-0\"}\n       [:p {:class \"font-semibold text-gray-800 text-sm\"}\n        (u/pessoa-nome (:pessoa_id entrada))]\n       (when (and (:descricao entrada) (not= (:descricao entrada) \"\"))\n         [:p {:class \"text-xs text-gray-500 truncate\"} (:descricao entrada)])]\n      [:div {:class \"text-right\"}\n       [:p {:class \"font-bold text-green-600 text-sm\"} (u/formatar-valor-br (:valor entrada))]\n       [:p {:class \"text-xs text-gray-400\"} (formatar-data-curta (:data entrada))]]]]))\n\n(defn entradas []\n  (let [entradas-mes @(rf/subscribe [:entradas-do-mes])\n        total        @(rf/subscribe [:total-entradas-mes])\n        divisao-barr (reduce (fn [acc e]\n                               (let [pid (keyword (:pessoa_id e))\n                                     pct (if (> total 0)\n                                           (* 100 (/ (:valor e) total))\n                                           0)]\n                                 (update acc pid #(+ (or % 0) pct))))\n                             {:andre 0 :bianca 0 :fernanda 0 :bruna 0}\n                             entradas-mes)]\n    [:div {:class \"flex flex-col pb-24\"}\n     [c/seletor-mes]\n\n     [:div {:class \"p-3\"}\n      ;; Resumo\n      [:div {:class \"bg-white rounded-xl border border-gray-100 p-3 shadow-sm mb-3\"}\n       [:p {:class \"text-xs text-gray-500 mb-0.5\"} \"Total de Entradas\"]\n       [:p {:class \"text-xl font-bold text-green-600 mb-2\"} (u/formatar-valor-br total)]\n       [c/barra-divisao divisao-barr]]\n\n      ;; Lista\n      (if (empty? entradas-mes)\n        [:div {:class \"flex flex-col items-center justify-center py-16 text-gray-400\"}\n         [:span {:class \"text-4xl mb-3\"} \"\ud83d\udcb0\"]\n         [:p {:class \"font-medium\"} \"Nenhuma entrada\"]\n         [:p {:class \"text-sm\"} \"Toque no + para adicionar\"]]\n        (for [e (sort-by :data entradas-mes)]\n          ^{:key (:id e)}\n          [item-entrada e]))]]))"]}