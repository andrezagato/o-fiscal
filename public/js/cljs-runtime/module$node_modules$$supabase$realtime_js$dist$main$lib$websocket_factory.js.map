{
"version":3,
"file":"module$node_modules$$supabase$realtime_js$dist$main$lib$websocket_factory.js",
"lineCount":38,
"mappings":"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",
"sources":["node_modules/@supabase/realtime-js/dist/main/lib/websocket-factory.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$supabase$realtime_js$dist$main$lib$websocket_factory\"] = function(require,module,exports,global) {\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.WebSocketFactory = void 0;\r\n/**\r\n * Utilities for creating WebSocket instances across runtimes.\r\n */\r\nclass WebSocketFactory {\r\n    /**\r\n     * Static-only utility \u2013 prevent instantiation.\r\n     */\r\n    constructor() { }\r\n    static detectEnvironment() {\r\n        var _a;\r\n        if (typeof WebSocket !== 'undefined') {\r\n            return { type: 'native', constructor: WebSocket };\r\n        }\r\n        if (typeof globalThis !== 'undefined' && typeof globalThis.WebSocket !== 'undefined') {\r\n            return { type: 'native', constructor: globalThis.WebSocket };\r\n        }\r\n        if (typeof global !== 'undefined' && typeof global.WebSocket !== 'undefined') {\r\n            return { type: 'native', constructor: global.WebSocket };\r\n        }\r\n        if (typeof globalThis !== 'undefined' &&\r\n            typeof globalThis.WebSocketPair !== 'undefined' &&\r\n            typeof globalThis.WebSocket === 'undefined') {\r\n            return {\r\n                type: 'cloudflare',\r\n                error: 'Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.',\r\n                workaround: 'Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime.',\r\n            };\r\n        }\r\n        if ((typeof globalThis !== 'undefined' && globalThis.EdgeRuntime) ||\r\n            (typeof navigator !== 'undefined' && ((_a = navigator.userAgent) === null || _a === void 0 ? void 0 : _a.includes('Vercel-Edge')))) {\r\n            return {\r\n                type: 'unsupported',\r\n                error: 'Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.',\r\n                workaround: 'Use serverless functions or a different deployment target for WebSocket functionality.',\r\n            };\r\n        }\r\n        // Use dynamic property access to avoid Next.js Edge Runtime static analysis warnings\r\n        const _process = globalThis['process'];\r\n        if (_process) {\r\n            const processVersions = _process['versions'];\r\n            if (processVersions && processVersions['node']) {\r\n                // Remove 'v' prefix if present and parse the major version\r\n                const versionString = processVersions['node'];\r\n                const nodeVersion = parseInt(versionString.replace(/^v/, '').split('.')[0]);\r\n                // Node.js 22+ should have native WebSocket\r\n                if (nodeVersion >= 22) {\r\n                    // Check if native WebSocket is available (should be in Node.js 22+)\r\n                    if (typeof globalThis.WebSocket !== 'undefined') {\r\n                        return { type: 'native', constructor: globalThis.WebSocket };\r\n                    }\r\n                    // If not available, user needs to provide it\r\n                    return {\r\n                        type: 'unsupported',\r\n                        error: `Node.js ${nodeVersion} detected but native WebSocket not found.`,\r\n                        workaround: 'Provide a WebSocket implementation via the transport option.',\r\n                    };\r\n                }\r\n                // Node.js < 22 doesn't have native WebSocket\r\n                return {\r\n                    type: 'unsupported',\r\n                    error: `Node.js ${nodeVersion} detected without native WebSocket support.`,\r\n                    workaround: 'For Node.js < 22, install \"ws\" package and provide it via the transport option:\\n' +\r\n                        'import ws from \"ws\"\\n' +\r\n                        'new RealtimeClient(url, { transport: ws })',\r\n                };\r\n            }\r\n        }\r\n        return {\r\n            type: 'unsupported',\r\n            error: 'Unknown JavaScript runtime without WebSocket support.',\r\n            workaround: \"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation.\",\r\n        };\r\n    }\r\n    /**\r\n     * Returns the best available WebSocket constructor for the current runtime.\r\n     *\r\n     * @example\r\n     * ```ts\r\n     * const WS = WebSocketFactory.getWebSocketConstructor()\r\n     * const socket = new WS('wss://realtime.supabase.co/socket')\r\n     * ```\r\n     */\r\n    static getWebSocketConstructor() {\r\n        const env = this.detectEnvironment();\r\n        if (env.constructor) {\r\n            return env.constructor;\r\n        }\r\n        let errorMessage = env.error || 'WebSocket not supported in this environment.';\r\n        if (env.workaround) {\r\n            errorMessage += `\\n\\nSuggested solution: ${env.workaround}`;\r\n        }\r\n        throw new Error(errorMessage);\r\n    }\r\n    /**\r\n     * Creates a WebSocket using the detected constructor.\r\n     *\r\n     * @example\r\n     * ```ts\r\n     * const socket = WebSocketFactory.createWebSocket('wss://realtime.supabase.co/socket')\r\n     * ```\r\n     */\r\n    static createWebSocket(url, protocols) {\r\n        const WS = this.getWebSocketConstructor();\r\n        return new WS(url, protocols);\r\n    }\r\n    /**\r\n     * Detects whether the runtime can establish WebSocket connections.\r\n     *\r\n     * @example\r\n     * ```ts\r\n     * if (!WebSocketFactory.isWebSocketSupported()) {\r\n     *   console.warn('Falling back to long polling')\r\n     * }\r\n     * ```\r\n     */\r\n    static isWebSocketSupported() {\r\n        try {\r\n            const env = this.detectEnvironment();\r\n            return env.type === 'native' || env.type === 'ws';\r\n        }\r\n        catch (_a) {\r\n            return false;\r\n        }\r\n    }\r\n}\r\nexports.WebSocketFactory = WebSocketFactory;\r\nexports.default = WebSocketFactory;\r\n//# sourceMappingURL=websocket-factory.js.map\n};"],
"names":["shadow$provide","require","module","exports","global","Object","defineProperty","value","WebSocketFactory","constructor","detectEnvironment","_a","WebSocket","type","globalThis","WebSocketPair","error","workaround","EdgeRuntime","navigator","userAgent","includes","_process","processVersions","nodeVersion","parseInt","versionString","replace","split","getWebSocketConstructor","env","errorMessage","Error","createWebSocket","url","protocols","WS","isWebSocketSupported","default"]
}
