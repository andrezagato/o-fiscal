["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/@supabase/realtime-js/dist/main/lib/serializer.js"],"~:js","shadow$provide[23]=function(S,ka,a){Object.defineProperty(a,\"__esModule\",{value:!0});class I{constructor(q){this.HEADER_LENGTH=1;this.USER_BROADCAST_PUSH_META_LENGTH=6;this.KINDS={userBroadcastPush:3,userBroadcast:4};this.BINARY_ENCODING=0;this.JSON_ENCODING=1;this.BROADCAST_EVENT=\"broadcast\";this.allowedMetadataKeys=[];this.allowedMetadataKeys=q!==null&&q!==void 0?q:[]}encode(q,D){return q.event!==this.BROADCAST_EVENT||q.payload instanceof ArrayBuffer||typeof q.payload.event!==\"string\"?D(JSON.stringify([q.join_ref,\nq.ref,q.topic,q.event,q.payload])):D(this._binaryEncodeUserBroadcastPush(q))}_binaryEncodeUserBroadcastPush(q){var D;return this._isArrayBuffer((D=q.payload)===null||D===void 0?void 0:D.payload)?this._encodeBinaryUserBroadcastPush(q):this._encodeJsonUserBroadcastPush(q)}_encodeBinaryUserBroadcastPush(q){var D,C;const G=(C=(D=q.payload)===null||D===void 0?void 0:D.payload)!==null&&C!==void 0?C:new ArrayBuffer(0);return this._encodeUserBroadcastPush(q,this.BINARY_ENCODING,G)}_encodeJsonUserBroadcastPush(q){var D,\nC;const G=(C=(D=q.payload)===null||D===void 0?void 0:D.payload)!==null&&C!==void 0?C:{};D=(new TextEncoder).encode(JSON.stringify(G)).buffer;return this._encodeUserBroadcastPush(q,this.JSON_ENCODING,D)}_encodeUserBroadcastPush(q,D,C){var G,E;const M=q.topic,d=(G=q.ref)!==null&&G!==void 0?G:\"\";G=(E=q.join_ref)!==null&&E!==void 0?E:\"\";E=q.payload.event;q=this.allowedMetadataKeys?this._pick(q.payload,this.allowedMetadataKeys):{};const K=Object.keys(q).length===0?\"\":JSON.stringify(q);if(G.length>255)throw Error(`joinRef length ${G.length} exceeds maximum of 255`);\nif(d.length>255)throw Error(`ref length ${d.length} exceeds maximum of 255`);if(M.length>255)throw Error(`topic length ${M.length} exceeds maximum of 255`);if(E.length>255)throw Error(`userEvent length ${E.length} exceeds maximum of 255`);if(K.length>255)throw Error(`metadata length ${K.length} exceeds maximum of 255`);q=new ArrayBuffer(this.HEADER_LENGTH+(this.USER_BROADCAST_PUSH_META_LENGTH+G.length+d.length+M.length+E.length+K.length));let p=new DataView(q),k=0;p.setUint8(k++,this.KINDS.userBroadcastPush);\np.setUint8(k++,G.length);p.setUint8(k++,d.length);p.setUint8(k++,M.length);p.setUint8(k++,E.length);p.setUint8(k++,K.length);p.setUint8(k++,D);Array.from(G,y=>p.setUint8(k++,y.charCodeAt(0)));Array.from(d,y=>p.setUint8(k++,y.charCodeAt(0)));Array.from(M,y=>p.setUint8(k++,y.charCodeAt(0)));Array.from(E,y=>p.setUint8(k++,y.charCodeAt(0)));Array.from(K,y=>p.setUint8(k++,y.charCodeAt(0)));D=new Uint8Array(q.byteLength+C.byteLength);D.set(new Uint8Array(q),0);D.set(new Uint8Array(C),q.byteLength);return D.buffer}decode(q,\nD){if(this._isArrayBuffer(q))return q=this._binaryDecode(q),D(q);if(typeof q===\"string\"){q=JSON.parse(q);const [C,G,E,M,d]=q;return D({join_ref:C,ref:G,topic:E,event:M,payload:d})}return D({})}_binaryDecode(q){const D=new DataView(q),C=D.getUint8(0),G=new TextDecoder;switch(C){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(q,D,G)}}_decodeUserBroadcast(q,D,C){var G=D.getUint8(1),E=D.getUint8(2);const M=D.getUint8(3),d=D.getUint8(4);let K=this.HEADER_LENGTH+4;D=C.decode(q.slice(K,K+\nG));K+=G;G=C.decode(q.slice(K,K+E));K+=E;E=C.decode(q.slice(K,K+M));q=q.slice(K+M,q.byteLength);C=d===this.JSON_ENCODING?JSON.parse(C.decode(q)):q;C={type:this.BROADCAST_EVENT,event:G,payload:C};M>0&&(C.meta=JSON.parse(E));return{join_ref:null,ref:null,topic:D,event:this.BROADCAST_EVENT,payload:C}}_isArrayBuffer(q){var D;return q instanceof ArrayBuffer||((D=q===null||q===void 0?void 0:q.constructor)===null||D===void 0?void 0:D.name)===\"ArrayBuffer\"}_pick(q,D){return q&&typeof q===\"object\"?Object.fromEntries(Object.entries(q).filter(([C])=>\nD.includes(C))):{}}}a.default=I}","~:source","shadow$provide[23] = function(require,module,exports) {\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Serializer {\r\n    constructor(allowedMetadataKeys) {\r\n        this.HEADER_LENGTH = 1;\r\n        this.USER_BROADCAST_PUSH_META_LENGTH = 6;\r\n        this.KINDS = { userBroadcastPush: 3, userBroadcast: 4 };\r\n        this.BINARY_ENCODING = 0;\r\n        this.JSON_ENCODING = 1;\r\n        this.BROADCAST_EVENT = 'broadcast';\r\n        this.allowedMetadataKeys = [];\r\n        this.allowedMetadataKeys = allowedMetadataKeys !== null && allowedMetadataKeys !== void 0 ? allowedMetadataKeys : [];\r\n    }\r\n    encode(msg, callback) {\r\n        if (msg.event === this.BROADCAST_EVENT &&\r\n            !(msg.payload instanceof ArrayBuffer) &&\r\n            typeof msg.payload.event === 'string') {\r\n            return callback(this._binaryEncodeUserBroadcastPush(msg));\r\n        }\r\n        let payload = [msg.join_ref, msg.ref, msg.topic, msg.event, msg.payload];\r\n        return callback(JSON.stringify(payload));\r\n    }\r\n    _binaryEncodeUserBroadcastPush(message) {\r\n        var _a;\r\n        if (this._isArrayBuffer((_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload)) {\r\n            return this._encodeBinaryUserBroadcastPush(message);\r\n        }\r\n        else {\r\n            return this._encodeJsonUserBroadcastPush(message);\r\n        }\r\n    }\r\n    _encodeBinaryUserBroadcastPush(message) {\r\n        var _a, _b;\r\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : new ArrayBuffer(0);\r\n        return this._encodeUserBroadcastPush(message, this.BINARY_ENCODING, userPayload);\r\n    }\r\n    _encodeJsonUserBroadcastPush(message) {\r\n        var _a, _b;\r\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : {};\r\n        const encoder = new TextEncoder();\r\n        const encodedUserPayload = encoder.encode(JSON.stringify(userPayload)).buffer;\r\n        return this._encodeUserBroadcastPush(message, this.JSON_ENCODING, encodedUserPayload);\r\n    }\r\n    _encodeUserBroadcastPush(message, encodingType, encodedPayload) {\r\n        var _a, _b;\r\n        const topic = message.topic;\r\n        const ref = (_a = message.ref) !== null && _a !== void 0 ? _a : '';\r\n        const joinRef = (_b = message.join_ref) !== null && _b !== void 0 ? _b : '';\r\n        const userEvent = message.payload.event;\r\n        // Filter metadata based on allowed keys\r\n        const rest = this.allowedMetadataKeys\r\n            ? this._pick(message.payload, this.allowedMetadataKeys)\r\n            : {};\r\n        const metadata = Object.keys(rest).length === 0 ? '' : JSON.stringify(rest);\r\n        // Validate lengths don't exceed uint8 max value (255)\r\n        if (joinRef.length > 255) {\r\n            throw new Error(`joinRef length ${joinRef.length} exceeds maximum of 255`);\r\n        }\r\n        if (ref.length > 255) {\r\n            throw new Error(`ref length ${ref.length} exceeds maximum of 255`);\r\n        }\r\n        if (topic.length > 255) {\r\n            throw new Error(`topic length ${topic.length} exceeds maximum of 255`);\r\n        }\r\n        if (userEvent.length > 255) {\r\n            throw new Error(`userEvent length ${userEvent.length} exceeds maximum of 255`);\r\n        }\r\n        if (metadata.length > 255) {\r\n            throw new Error(`metadata length ${metadata.length} exceeds maximum of 255`);\r\n        }\r\n        const metaLength = this.USER_BROADCAST_PUSH_META_LENGTH +\r\n            joinRef.length +\r\n            ref.length +\r\n            topic.length +\r\n            userEvent.length +\r\n            metadata.length;\r\n        const header = new ArrayBuffer(this.HEADER_LENGTH + metaLength);\r\n        let view = new DataView(header);\r\n        let offset = 0;\r\n        view.setUint8(offset++, this.KINDS.userBroadcastPush); // kind\r\n        view.setUint8(offset++, joinRef.length);\r\n        view.setUint8(offset++, ref.length);\r\n        view.setUint8(offset++, topic.length);\r\n        view.setUint8(offset++, userEvent.length);\r\n        view.setUint8(offset++, metadata.length);\r\n        view.setUint8(offset++, encodingType);\r\n        Array.from(joinRef, (char) => view.setUint8(offset++, char.charCodeAt(0)));\r\n        Array.from(ref, (char) => view.setUint8(offset++, char.charCodeAt(0)));\r\n        Array.from(topic, (char) => view.setUint8(offset++, char.charCodeAt(0)));\r\n        Array.from(userEvent, (char) => view.setUint8(offset++, char.charCodeAt(0)));\r\n        Array.from(metadata, (char) => view.setUint8(offset++, char.charCodeAt(0)));\r\n        var combined = new Uint8Array(header.byteLength + encodedPayload.byteLength);\r\n        combined.set(new Uint8Array(header), 0);\r\n        combined.set(new Uint8Array(encodedPayload), header.byteLength);\r\n        return combined.buffer;\r\n    }\r\n    decode(rawPayload, callback) {\r\n        if (this._isArrayBuffer(rawPayload)) {\r\n            let result = this._binaryDecode(rawPayload);\r\n            return callback(result);\r\n        }\r\n        if (typeof rawPayload === 'string') {\r\n            const jsonPayload = JSON.parse(rawPayload);\r\n            const [join_ref, ref, topic, event, payload] = jsonPayload;\r\n            return callback({ join_ref, ref, topic, event, payload });\r\n        }\r\n        return callback({});\r\n    }\r\n    _binaryDecode(buffer) {\r\n        const view = new DataView(buffer);\r\n        const kind = view.getUint8(0);\r\n        const decoder = new TextDecoder();\r\n        switch (kind) {\r\n            case this.KINDS.userBroadcast:\r\n                return this._decodeUserBroadcast(buffer, view, decoder);\r\n        }\r\n    }\r\n    _decodeUserBroadcast(buffer, view, decoder) {\r\n        const topicSize = view.getUint8(1);\r\n        const userEventSize = view.getUint8(2);\r\n        const metadataSize = view.getUint8(3);\r\n        const payloadEncoding = view.getUint8(4);\r\n        let offset = this.HEADER_LENGTH + 4;\r\n        const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\r\n        offset = offset + topicSize;\r\n        const userEvent = decoder.decode(buffer.slice(offset, offset + userEventSize));\r\n        offset = offset + userEventSize;\r\n        const metadata = decoder.decode(buffer.slice(offset, offset + metadataSize));\r\n        offset = offset + metadataSize;\r\n        const payload = buffer.slice(offset, buffer.byteLength);\r\n        const parsedPayload = payloadEncoding === this.JSON_ENCODING ? JSON.parse(decoder.decode(payload)) : payload;\r\n        const data = {\r\n            type: this.BROADCAST_EVENT,\r\n            event: userEvent,\r\n            payload: parsedPayload,\r\n        };\r\n        // Metadata is optional and always JSON encoded\r\n        if (metadataSize > 0) {\r\n            data['meta'] = JSON.parse(metadata);\r\n        }\r\n        return { join_ref: null, ref: null, topic: topic, event: this.BROADCAST_EVENT, payload: data };\r\n    }\r\n    _isArrayBuffer(buffer) {\r\n        var _a;\r\n        return buffer instanceof ArrayBuffer || ((_a = buffer === null || buffer === void 0 ? void 0 : buffer.constructor) === null || _a === void 0 ? void 0 : _a.name) === 'ArrayBuffer';\r\n    }\r\n    _pick(obj, keys) {\r\n        if (!obj || typeof obj !== 'object') {\r\n            return {};\r\n        }\r\n        return Object.fromEntries(Object.entries(obj).filter(([key]) => keys.includes(key)));\r\n    }\r\n}\r\nexports.default = Serializer;\r\n//# sourceMappingURL=serializer.js.map\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$shadow.js"]],"~:properties",["^5",["USER_BROADCAST_PUSH_META_LENGTH","JSON_ENCODING","allowedMetadataKeys","join_ref","BROADCAST_EVENT","HEADER_LENGTH","__esModule","event","value","BINARY_ENCODING","userBroadcastPush","type","ref","KINDS","userBroadcast","payload","default","topic"]],"~:compiled-at",1771869280844,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$$supabase$realtime_js$dist$main$lib$serializer.js\",\n\"lineCount\":8,\n\"mappings\":\"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\",\n\"sources\":[\"node_modules/@supabase/realtime-js/dist/main/lib/serializer.js\"],\n\"sourcesContent\":[\"shadow$provide[23] = function(require,module,exports) {\\n\\\"use strict\\\";\\r\\nObject.defineProperty(exports, \\\"__esModule\\\", { value: true });\\r\\nclass Serializer {\\r\\n    constructor(allowedMetadataKeys) {\\r\\n        this.HEADER_LENGTH = 1;\\r\\n        this.USER_BROADCAST_PUSH_META_LENGTH = 6;\\r\\n        this.KINDS = { userBroadcastPush: 3, userBroadcast: 4 };\\r\\n        this.BINARY_ENCODING = 0;\\r\\n        this.JSON_ENCODING = 1;\\r\\n        this.BROADCAST_EVENT = 'broadcast';\\r\\n        this.allowedMetadataKeys = [];\\r\\n        this.allowedMetadataKeys = allowedMetadataKeys !== null && allowedMetadataKeys !== void 0 ? allowedMetadataKeys : [];\\r\\n    }\\r\\n    encode(msg, callback) {\\r\\n        if (msg.event === this.BROADCAST_EVENT &&\\r\\n            !(msg.payload instanceof ArrayBuffer) &&\\r\\n            typeof msg.payload.event === 'string') {\\r\\n            return callback(this._binaryEncodeUserBroadcastPush(msg));\\r\\n        }\\r\\n        let payload = [msg.join_ref, msg.ref, msg.topic, msg.event, msg.payload];\\r\\n        return callback(JSON.stringify(payload));\\r\\n    }\\r\\n    _binaryEncodeUserBroadcastPush(message) {\\r\\n        var _a;\\r\\n        if (this._isArrayBuffer((_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload)) {\\r\\n            return this._encodeBinaryUserBroadcastPush(message);\\r\\n        }\\r\\n        else {\\r\\n            return this._encodeJsonUserBroadcastPush(message);\\r\\n        }\\r\\n    }\\r\\n    _encodeBinaryUserBroadcastPush(message) {\\r\\n        var _a, _b;\\r\\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : new ArrayBuffer(0);\\r\\n        return this._encodeUserBroadcastPush(message, this.BINARY_ENCODING, userPayload);\\r\\n    }\\r\\n    _encodeJsonUserBroadcastPush(message) {\\r\\n        var _a, _b;\\r\\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : {};\\r\\n        const encoder = new TextEncoder();\\r\\n        const encodedUserPayload = encoder.encode(JSON.stringify(userPayload)).buffer;\\r\\n        return this._encodeUserBroadcastPush(message, this.JSON_ENCODING, encodedUserPayload);\\r\\n    }\\r\\n    _encodeUserBroadcastPush(message, encodingType, encodedPayload) {\\r\\n        var _a, _b;\\r\\n        const topic = message.topic;\\r\\n        const ref = (_a = message.ref) !== null && _a !== void 0 ? _a : '';\\r\\n        const joinRef = (_b = message.join_ref) !== null && _b !== void 0 ? _b : '';\\r\\n        const userEvent = message.payload.event;\\r\\n        // Filter metadata based on allowed keys\\r\\n        const rest = this.allowedMetadataKeys\\r\\n            ? this._pick(message.payload, this.allowedMetadataKeys)\\r\\n            : {};\\r\\n        const metadata = Object.keys(rest).length === 0 ? '' : JSON.stringify(rest);\\r\\n        // Validate lengths don't exceed uint8 max value (255)\\r\\n        if (joinRef.length > 255) {\\r\\n            throw new Error(`joinRef length ${joinRef.length} exceeds maximum of 255`);\\r\\n        }\\r\\n        if (ref.length > 255) {\\r\\n            throw new Error(`ref length ${ref.length} exceeds maximum of 255`);\\r\\n        }\\r\\n        if (topic.length > 255) {\\r\\n            throw new Error(`topic length ${topic.length} exceeds maximum of 255`);\\r\\n        }\\r\\n        if (userEvent.length > 255) {\\r\\n            throw new Error(`userEvent length ${userEvent.length} exceeds maximum of 255`);\\r\\n        }\\r\\n        if (metadata.length > 255) {\\r\\n            throw new Error(`metadata length ${metadata.length} exceeds maximum of 255`);\\r\\n        }\\r\\n        const metaLength = this.USER_BROADCAST_PUSH_META_LENGTH +\\r\\n            joinRef.length +\\r\\n            ref.length +\\r\\n            topic.length +\\r\\n            userEvent.length +\\r\\n            metadata.length;\\r\\n        const header = new ArrayBuffer(this.HEADER_LENGTH + metaLength);\\r\\n        let view = new DataView(header);\\r\\n        let offset = 0;\\r\\n        view.setUint8(offset++, this.KINDS.userBroadcastPush); // kind\\r\\n        view.setUint8(offset++, joinRef.length);\\r\\n        view.setUint8(offset++, ref.length);\\r\\n        view.setUint8(offset++, topic.length);\\r\\n        view.setUint8(offset++, userEvent.length);\\r\\n        view.setUint8(offset++, metadata.length);\\r\\n        view.setUint8(offset++, encodingType);\\r\\n        Array.from(joinRef, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\r\\n        Array.from(ref, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\r\\n        Array.from(topic, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\r\\n        Array.from(userEvent, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\r\\n        Array.from(metadata, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\r\\n        var combined = new Uint8Array(header.byteLength + encodedPayload.byteLength);\\r\\n        combined.set(new Uint8Array(header), 0);\\r\\n        combined.set(new Uint8Array(encodedPayload), header.byteLength);\\r\\n        return combined.buffer;\\r\\n    }\\r\\n    decode(rawPayload, callback) {\\r\\n        if (this._isArrayBuffer(rawPayload)) {\\r\\n            let result = this._binaryDecode(rawPayload);\\r\\n            return callback(result);\\r\\n        }\\r\\n        if (typeof rawPayload === 'string') {\\r\\n            const jsonPayload = JSON.parse(rawPayload);\\r\\n            const [join_ref, ref, topic, event, payload] = jsonPayload;\\r\\n            return callback({ join_ref, ref, topic, event, payload });\\r\\n        }\\r\\n        return callback({});\\r\\n    }\\r\\n    _binaryDecode(buffer) {\\r\\n        const view = new DataView(buffer);\\r\\n        const kind = view.getUint8(0);\\r\\n        const decoder = new TextDecoder();\\r\\n        switch (kind) {\\r\\n            case this.KINDS.userBroadcast:\\r\\n                return this._decodeUserBroadcast(buffer, view, decoder);\\r\\n        }\\r\\n    }\\r\\n    _decodeUserBroadcast(buffer, view, decoder) {\\r\\n        const topicSize = view.getUint8(1);\\r\\n        const userEventSize = view.getUint8(2);\\r\\n        const metadataSize = view.getUint8(3);\\r\\n        const payloadEncoding = view.getUint8(4);\\r\\n        let offset = this.HEADER_LENGTH + 4;\\r\\n        const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\\r\\n        offset = offset + topicSize;\\r\\n        const userEvent = decoder.decode(buffer.slice(offset, offset + userEventSize));\\r\\n        offset = offset + userEventSize;\\r\\n        const metadata = decoder.decode(buffer.slice(offset, offset + metadataSize));\\r\\n        offset = offset + metadataSize;\\r\\n        const payload = buffer.slice(offset, buffer.byteLength);\\r\\n        const parsedPayload = payloadEncoding === this.JSON_ENCODING ? JSON.parse(decoder.decode(payload)) : payload;\\r\\n        const data = {\\r\\n            type: this.BROADCAST_EVENT,\\r\\n            event: userEvent,\\r\\n            payload: parsedPayload,\\r\\n        };\\r\\n        // Metadata is optional and always JSON encoded\\r\\n        if (metadataSize > 0) {\\r\\n            data['meta'] = JSON.parse(metadata);\\r\\n        }\\r\\n        return { join_ref: null, ref: null, topic: topic, event: this.BROADCAST_EVENT, payload: data };\\r\\n    }\\r\\n    _isArrayBuffer(buffer) {\\r\\n        var _a;\\r\\n        return buffer instanceof ArrayBuffer || ((_a = buffer === null || buffer === void 0 ? void 0 : buffer.constructor) === null || _a === void 0 ? void 0 : _a.name) === 'ArrayBuffer';\\r\\n    }\\r\\n    _pick(obj, keys) {\\r\\n        if (!obj || typeof obj !== 'object') {\\r\\n            return {};\\r\\n        }\\r\\n        return Object.fromEntries(Object.entries(obj).filter(([key]) => keys.includes(key)));\\r\\n    }\\r\\n}\\r\\nexports.default = Serializer;\\r\\n//# sourceMappingURL=serializer.js.map\\n};\"],\n\"names\":[\"shadow$provide\",\"require\",\"module\",\"exports\",\"Object\",\"defineProperty\",\"value\",\"Serializer\",\"constructor\",\"allowedMetadataKeys\",\"HEADER_LENGTH\",\"USER_BROADCAST_PUSH_META_LENGTH\",\"KINDS\",\"userBroadcastPush\",\"userBroadcast\",\"BINARY_ENCODING\",\"JSON_ENCODING\",\"BROADCAST_EVENT\",\"encode\",\"msg\",\"callback\",\"event\",\"payload\",\"ArrayBuffer\",\"JSON\",\"stringify\",\"join_ref\",\"ref\",\"topic\",\"_binaryEncodeUserBroadcastPush\",\"message\",\"_a\",\"_isArrayBuffer\",\"_encodeBinaryUserBroadcastPush\",\"_encodeJsonUserBroadcastPush\",\"_b\",\"userPayload\",\"_encodeUserBroadcastPush\",\"encodedUserPayload\",\"encoder\",\"TextEncoder\",\"buffer\",\"encodingType\",\"encodedPayload\",\"joinRef\",\"userEvent\",\"rest\",\"_pick\",\"metadata\",\"keys\",\"length\",\"Error\",\"header\",\"view\",\"DataView\",\"offset\",\"setUint8\",\"Array\",\"from\",\"char\",\"charCodeAt\",\"combined\",\"Uint8Array\",\"byteLength\",\"set\",\"decode\",\"rawPayload\",\"result\",\"_binaryDecode\",\"jsonPayload\",\"parse\",\"kind\",\"getUint8\",\"decoder\",\"TextDecoder\",\"_decodeUserBroadcast\",\"topicSize\",\"userEventSize\",\"metadataSize\",\"payloadEncoding\",\"slice\",\"parsedPayload\",\"data\",\"type\",\"name\",\"obj\",\"fromEntries\",\"entries\",\"filter\",\"key\",\"includes\",\"default\"]\n}\n"]