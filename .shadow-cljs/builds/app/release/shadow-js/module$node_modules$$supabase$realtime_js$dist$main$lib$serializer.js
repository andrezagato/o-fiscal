["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/@supabase/realtime-js/dist/main/lib/serializer.js"],"~:js","shadow$provide[23]=function(I,R,a){Object.defineProperty(a,\"__esModule\",{value:!0});class G{constructor(l){this.HEADER_LENGTH=1;this.USER_BROADCAST_PUSH_META_LENGTH=6;this.KINDS={userBroadcastPush:3,userBroadcast:4};this.BINARY_ENCODING=0;this.JSON_ENCODING=1;this.BROADCAST_EVENT=\"broadcast\";this.allowedMetadataKeys=[];this.allowedMetadataKeys=l!==null&&l!==void 0?l:[]}encode(l,x){return l.event!==this.BROADCAST_EVENT||l.payload instanceof ArrayBuffer||typeof l.payload.event!==\"string\"?x(JSON.stringify([l.join_ref,\nl.ref,l.topic,l.event,l.payload])):x(this._binaryEncodeUserBroadcastPush(l))}_binaryEncodeUserBroadcastPush(l){var x;return this._isArrayBuffer((x=l.payload)===null||x===void 0?void 0:x.payload)?this._encodeBinaryUserBroadcastPush(l):this._encodeJsonUserBroadcastPush(l)}_encodeBinaryUserBroadcastPush(l){var x,w;const z=(w=(x=l.payload)===null||x===void 0?void 0:x.payload)!==null&&w!==void 0?w:new ArrayBuffer(0);return this._encodeUserBroadcastPush(l,this.BINARY_ENCODING,z)}_encodeJsonUserBroadcastPush(l){var x,\nw;const z=(w=(x=l.payload)===null||x===void 0?void 0:x.payload)!==null&&w!==void 0?w:{};x=(new TextEncoder).encode(JSON.stringify(z)).buffer;return this._encodeUserBroadcastPush(l,this.JSON_ENCODING,x)}_encodeUserBroadcastPush(l,x,w){var z,y;const F=l.topic,b=(z=l.ref)!==null&&z!==void 0?z:\"\";z=(y=l.join_ref)!==null&&y!==void 0?y:\"\";y=l.payload.event;l=this.allowedMetadataKeys?this._pick(l.payload,this.allowedMetadataKeys):{};const D=Object.keys(l).length===0?\"\":JSON.stringify(l);if(z.length>255)throw Error(`joinRef length ${z.length} exceeds maximum of 255`);\nif(b.length>255)throw Error(`ref length ${b.length} exceeds maximum of 255`);if(F.length>255)throw Error(`topic length ${F.length} exceeds maximum of 255`);if(y.length>255)throw Error(`userEvent length ${y.length} exceeds maximum of 255`);if(D.length>255)throw Error(`metadata length ${D.length} exceeds maximum of 255`);l=new ArrayBuffer(this.HEADER_LENGTH+(this.USER_BROADCAST_PUSH_META_LENGTH+z.length+b.length+F.length+y.length+D.length));let k=new DataView(l),f=0;k.setUint8(f++,this.KINDS.userBroadcastPush);\nk.setUint8(f++,z.length);k.setUint8(f++,b.length);k.setUint8(f++,F.length);k.setUint8(f++,y.length);k.setUint8(f++,D.length);k.setUint8(f++,x);Array.from(z,t=>k.setUint8(f++,t.charCodeAt(0)));Array.from(b,t=>k.setUint8(f++,t.charCodeAt(0)));Array.from(F,t=>k.setUint8(f++,t.charCodeAt(0)));Array.from(y,t=>k.setUint8(f++,t.charCodeAt(0)));Array.from(D,t=>k.setUint8(f++,t.charCodeAt(0)));x=new Uint8Array(l.byteLength+w.byteLength);x.set(new Uint8Array(l),0);x.set(new Uint8Array(w),l.byteLength);return x.buffer}decode(l,\nx){if(this._isArrayBuffer(l))return l=this._binaryDecode(l),x(l);if(typeof l===\"string\"){l=JSON.parse(l);const [w,z,y,F,b]=l;return x({join_ref:w,ref:z,topic:y,event:F,payload:b})}return x({})}_binaryDecode(l){const x=new DataView(l),w=x.getUint8(0),z=new TextDecoder;switch(w){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(l,x,z)}}_decodeUserBroadcast(l,x,w){var z=x.getUint8(1),y=x.getUint8(2);const F=x.getUint8(3),b=x.getUint8(4);let D=this.HEADER_LENGTH+4;x=w.decode(l.slice(D,D+\nz));D+=z;z=w.decode(l.slice(D,D+y));D+=y;y=w.decode(l.slice(D,D+F));l=l.slice(D+F,l.byteLength);w=b===this.JSON_ENCODING?JSON.parse(w.decode(l)):l;w={type:this.BROADCAST_EVENT,event:z,payload:w};F>0&&(w.meta=JSON.parse(y));return{join_ref:null,ref:null,topic:x,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(l){var x;return l instanceof ArrayBuffer||((x=l===null||l===void 0?void 0:l.constructor)===null||x===void 0?void 0:x.name)===\"ArrayBuffer\"}_pick(l,x){return l&&typeof l===\"object\"?Object.fromEntries(Object.entries(l).filter(([w])=>\nx.includes(w))):{}}}a.default=G}","~:source","shadow$provide[23] = function(require,module,exports) {\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass Serializer {\n    constructor(allowedMetadataKeys) {\n        this.HEADER_LENGTH = 1;\n        this.USER_BROADCAST_PUSH_META_LENGTH = 6;\n        this.KINDS = { userBroadcastPush: 3, userBroadcast: 4 };\n        this.BINARY_ENCODING = 0;\n        this.JSON_ENCODING = 1;\n        this.BROADCAST_EVENT = 'broadcast';\n        this.allowedMetadataKeys = [];\n        this.allowedMetadataKeys = allowedMetadataKeys !== null && allowedMetadataKeys !== void 0 ? allowedMetadataKeys : [];\n    }\n    encode(msg, callback) {\n        if (msg.event === this.BROADCAST_EVENT &&\n            !(msg.payload instanceof ArrayBuffer) &&\n            typeof msg.payload.event === 'string') {\n            return callback(this._binaryEncodeUserBroadcastPush(msg));\n        }\n        let payload = [msg.join_ref, msg.ref, msg.topic, msg.event, msg.payload];\n        return callback(JSON.stringify(payload));\n    }\n    _binaryEncodeUserBroadcastPush(message) {\n        var _a;\n        if (this._isArrayBuffer((_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload)) {\n            return this._encodeBinaryUserBroadcastPush(message);\n        }\n        else {\n            return this._encodeJsonUserBroadcastPush(message);\n        }\n    }\n    _encodeBinaryUserBroadcastPush(message) {\n        var _a, _b;\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : new ArrayBuffer(0);\n        return this._encodeUserBroadcastPush(message, this.BINARY_ENCODING, userPayload);\n    }\n    _encodeJsonUserBroadcastPush(message) {\n        var _a, _b;\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : {};\n        const encoder = new TextEncoder();\n        const encodedUserPayload = encoder.encode(JSON.stringify(userPayload)).buffer;\n        return this._encodeUserBroadcastPush(message, this.JSON_ENCODING, encodedUserPayload);\n    }\n    _encodeUserBroadcastPush(message, encodingType, encodedPayload) {\n        var _a, _b;\n        const topic = message.topic;\n        const ref = (_a = message.ref) !== null && _a !== void 0 ? _a : '';\n        const joinRef = (_b = message.join_ref) !== null && _b !== void 0 ? _b : '';\n        const userEvent = message.payload.event;\n        // Filter metadata based on allowed keys\n        const rest = this.allowedMetadataKeys\n            ? this._pick(message.payload, this.allowedMetadataKeys)\n            : {};\n        const metadata = Object.keys(rest).length === 0 ? '' : JSON.stringify(rest);\n        // Validate lengths don't exceed uint8 max value (255)\n        if (joinRef.length > 255) {\n            throw new Error(`joinRef length ${joinRef.length} exceeds maximum of 255`);\n        }\n        if (ref.length > 255) {\n            throw new Error(`ref length ${ref.length} exceeds maximum of 255`);\n        }\n        if (topic.length > 255) {\n            throw new Error(`topic length ${topic.length} exceeds maximum of 255`);\n        }\n        if (userEvent.length > 255) {\n            throw new Error(`userEvent length ${userEvent.length} exceeds maximum of 255`);\n        }\n        if (metadata.length > 255) {\n            throw new Error(`metadata length ${metadata.length} exceeds maximum of 255`);\n        }\n        const metaLength = this.USER_BROADCAST_PUSH_META_LENGTH +\n            joinRef.length +\n            ref.length +\n            topic.length +\n            userEvent.length +\n            metadata.length;\n        const header = new ArrayBuffer(this.HEADER_LENGTH + metaLength);\n        let view = new DataView(header);\n        let offset = 0;\n        view.setUint8(offset++, this.KINDS.userBroadcastPush); // kind\n        view.setUint8(offset++, joinRef.length);\n        view.setUint8(offset++, ref.length);\n        view.setUint8(offset++, topic.length);\n        view.setUint8(offset++, userEvent.length);\n        view.setUint8(offset++, metadata.length);\n        view.setUint8(offset++, encodingType);\n        Array.from(joinRef, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(ref, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(topic, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(userEvent, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        Array.from(metadata, (char) => view.setUint8(offset++, char.charCodeAt(0)));\n        var combined = new Uint8Array(header.byteLength + encodedPayload.byteLength);\n        combined.set(new Uint8Array(header), 0);\n        combined.set(new Uint8Array(encodedPayload), header.byteLength);\n        return combined.buffer;\n    }\n    decode(rawPayload, callback) {\n        if (this._isArrayBuffer(rawPayload)) {\n            let result = this._binaryDecode(rawPayload);\n            return callback(result);\n        }\n        if (typeof rawPayload === 'string') {\n            const jsonPayload = JSON.parse(rawPayload);\n            const [join_ref, ref, topic, event, payload] = jsonPayload;\n            return callback({ join_ref, ref, topic, event, payload });\n        }\n        return callback({});\n    }\n    _binaryDecode(buffer) {\n        const view = new DataView(buffer);\n        const kind = view.getUint8(0);\n        const decoder = new TextDecoder();\n        switch (kind) {\n            case this.KINDS.userBroadcast:\n                return this._decodeUserBroadcast(buffer, view, decoder);\n        }\n    }\n    _decodeUserBroadcast(buffer, view, decoder) {\n        const topicSize = view.getUint8(1);\n        const userEventSize = view.getUint8(2);\n        const metadataSize = view.getUint8(3);\n        const payloadEncoding = view.getUint8(4);\n        let offset = this.HEADER_LENGTH + 4;\n        const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\n        offset = offset + topicSize;\n        const userEvent = decoder.decode(buffer.slice(offset, offset + userEventSize));\n        offset = offset + userEventSize;\n        const metadata = decoder.decode(buffer.slice(offset, offset + metadataSize));\n        offset = offset + metadataSize;\n        const payload = buffer.slice(offset, buffer.byteLength);\n        const parsedPayload = payloadEncoding === this.JSON_ENCODING ? JSON.parse(decoder.decode(payload)) : payload;\n        const data = {\n            type: this.BROADCAST_EVENT,\n            event: userEvent,\n            payload: parsedPayload,\n        };\n        // Metadata is optional and always JSON encoded\n        if (metadataSize > 0) {\n            data['meta'] = JSON.parse(metadata);\n        }\n        return { join_ref: null, ref: null, topic: topic, event: this.BROADCAST_EVENT, payload: data };\n    }\n    _isArrayBuffer(buffer) {\n        var _a;\n        return buffer instanceof ArrayBuffer || ((_a = buffer === null || buffer === void 0 ? void 0 : buffer.constructor) === null || _a === void 0 ? void 0 : _a.name) === 'ArrayBuffer';\n    }\n    _pick(obj, keys) {\n        if (!obj || typeof obj !== 'object') {\n            return {};\n        }\n        return Object.fromEntries(Object.entries(obj).filter(([key]) => keys.includes(key)));\n    }\n}\nexports.default = Serializer;\n//# sourceMappingURL=serializer.js.map\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$shadow.js"]],"~:properties",["^5",["USER_BROADCAST_PUSH_META_LENGTH","JSON_ENCODING","allowedMetadataKeys","join_ref","BROADCAST_EVENT","HEADER_LENGTH","__esModule","event","value","BINARY_ENCODING","userBroadcastPush","type","ref","KINDS","userBroadcast","payload","default","topic"]],"~:compiled-at",1771725993755,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$$supabase$realtime_js$dist$main$lib$serializer.js\",\n\"lineCount\":8,\n\"mappings\":\"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\",\n\"sources\":[\"node_modules/@supabase/realtime-js/dist/main/lib/serializer.js\"],\n\"sourcesContent\":[\"shadow$provide[23] = function(require,module,exports) {\\n\\\"use strict\\\";\\nObject.defineProperty(exports, \\\"__esModule\\\", { value: true });\\nclass Serializer {\\n    constructor(allowedMetadataKeys) {\\n        this.HEADER_LENGTH = 1;\\n        this.USER_BROADCAST_PUSH_META_LENGTH = 6;\\n        this.KINDS = { userBroadcastPush: 3, userBroadcast: 4 };\\n        this.BINARY_ENCODING = 0;\\n        this.JSON_ENCODING = 1;\\n        this.BROADCAST_EVENT = 'broadcast';\\n        this.allowedMetadataKeys = [];\\n        this.allowedMetadataKeys = allowedMetadataKeys !== null && allowedMetadataKeys !== void 0 ? allowedMetadataKeys : [];\\n    }\\n    encode(msg, callback) {\\n        if (msg.event === this.BROADCAST_EVENT &&\\n            !(msg.payload instanceof ArrayBuffer) &&\\n            typeof msg.payload.event === 'string') {\\n            return callback(this._binaryEncodeUserBroadcastPush(msg));\\n        }\\n        let payload = [msg.join_ref, msg.ref, msg.topic, msg.event, msg.payload];\\n        return callback(JSON.stringify(payload));\\n    }\\n    _binaryEncodeUserBroadcastPush(message) {\\n        var _a;\\n        if (this._isArrayBuffer((_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload)) {\\n            return this._encodeBinaryUserBroadcastPush(message);\\n        }\\n        else {\\n            return this._encodeJsonUserBroadcastPush(message);\\n        }\\n    }\\n    _encodeBinaryUserBroadcastPush(message) {\\n        var _a, _b;\\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : new ArrayBuffer(0);\\n        return this._encodeUserBroadcastPush(message, this.BINARY_ENCODING, userPayload);\\n    }\\n    _encodeJsonUserBroadcastPush(message) {\\n        var _a, _b;\\n        const userPayload = (_b = (_a = message.payload) === null || _a === void 0 ? void 0 : _a.payload) !== null && _b !== void 0 ? _b : {};\\n        const encoder = new TextEncoder();\\n        const encodedUserPayload = encoder.encode(JSON.stringify(userPayload)).buffer;\\n        return this._encodeUserBroadcastPush(message, this.JSON_ENCODING, encodedUserPayload);\\n    }\\n    _encodeUserBroadcastPush(message, encodingType, encodedPayload) {\\n        var _a, _b;\\n        const topic = message.topic;\\n        const ref = (_a = message.ref) !== null && _a !== void 0 ? _a : '';\\n        const joinRef = (_b = message.join_ref) !== null && _b !== void 0 ? _b : '';\\n        const userEvent = message.payload.event;\\n        // Filter metadata based on allowed keys\\n        const rest = this.allowedMetadataKeys\\n            ? this._pick(message.payload, this.allowedMetadataKeys)\\n            : {};\\n        const metadata = Object.keys(rest).length === 0 ? '' : JSON.stringify(rest);\\n        // Validate lengths don't exceed uint8 max value (255)\\n        if (joinRef.length > 255) {\\n            throw new Error(`joinRef length ${joinRef.length} exceeds maximum of 255`);\\n        }\\n        if (ref.length > 255) {\\n            throw new Error(`ref length ${ref.length} exceeds maximum of 255`);\\n        }\\n        if (topic.length > 255) {\\n            throw new Error(`topic length ${topic.length} exceeds maximum of 255`);\\n        }\\n        if (userEvent.length > 255) {\\n            throw new Error(`userEvent length ${userEvent.length} exceeds maximum of 255`);\\n        }\\n        if (metadata.length > 255) {\\n            throw new Error(`metadata length ${metadata.length} exceeds maximum of 255`);\\n        }\\n        const metaLength = this.USER_BROADCAST_PUSH_META_LENGTH +\\n            joinRef.length +\\n            ref.length +\\n            topic.length +\\n            userEvent.length +\\n            metadata.length;\\n        const header = new ArrayBuffer(this.HEADER_LENGTH + metaLength);\\n        let view = new DataView(header);\\n        let offset = 0;\\n        view.setUint8(offset++, this.KINDS.userBroadcastPush); // kind\\n        view.setUint8(offset++, joinRef.length);\\n        view.setUint8(offset++, ref.length);\\n        view.setUint8(offset++, topic.length);\\n        view.setUint8(offset++, userEvent.length);\\n        view.setUint8(offset++, metadata.length);\\n        view.setUint8(offset++, encodingType);\\n        Array.from(joinRef, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\n        Array.from(ref, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\n        Array.from(topic, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\n        Array.from(userEvent, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\n        Array.from(metadata, (char) => view.setUint8(offset++, char.charCodeAt(0)));\\n        var combined = new Uint8Array(header.byteLength + encodedPayload.byteLength);\\n        combined.set(new Uint8Array(header), 0);\\n        combined.set(new Uint8Array(encodedPayload), header.byteLength);\\n        return combined.buffer;\\n    }\\n    decode(rawPayload, callback) {\\n        if (this._isArrayBuffer(rawPayload)) {\\n            let result = this._binaryDecode(rawPayload);\\n            return callback(result);\\n        }\\n        if (typeof rawPayload === 'string') {\\n            const jsonPayload = JSON.parse(rawPayload);\\n            const [join_ref, ref, topic, event, payload] = jsonPayload;\\n            return callback({ join_ref, ref, topic, event, payload });\\n        }\\n        return callback({});\\n    }\\n    _binaryDecode(buffer) {\\n        const view = new DataView(buffer);\\n        const kind = view.getUint8(0);\\n        const decoder = new TextDecoder();\\n        switch (kind) {\\n            case this.KINDS.userBroadcast:\\n                return this._decodeUserBroadcast(buffer, view, decoder);\\n        }\\n    }\\n    _decodeUserBroadcast(buffer, view, decoder) {\\n        const topicSize = view.getUint8(1);\\n        const userEventSize = view.getUint8(2);\\n        const metadataSize = view.getUint8(3);\\n        const payloadEncoding = view.getUint8(4);\\n        let offset = this.HEADER_LENGTH + 4;\\n        const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\\n        offset = offset + topicSize;\\n        const userEvent = decoder.decode(buffer.slice(offset, offset + userEventSize));\\n        offset = offset + userEventSize;\\n        const metadata = decoder.decode(buffer.slice(offset, offset + metadataSize));\\n        offset = offset + metadataSize;\\n        const payload = buffer.slice(offset, buffer.byteLength);\\n        const parsedPayload = payloadEncoding === this.JSON_ENCODING ? JSON.parse(decoder.decode(payload)) : payload;\\n        const data = {\\n            type: this.BROADCAST_EVENT,\\n            event: userEvent,\\n            payload: parsedPayload,\\n        };\\n        // Metadata is optional and always JSON encoded\\n        if (metadataSize > 0) {\\n            data['meta'] = JSON.parse(metadata);\\n        }\\n        return { join_ref: null, ref: null, topic: topic, event: this.BROADCAST_EVENT, payload: data };\\n    }\\n    _isArrayBuffer(buffer) {\\n        var _a;\\n        return buffer instanceof ArrayBuffer || ((_a = buffer === null || buffer === void 0 ? void 0 : buffer.constructor) === null || _a === void 0 ? void 0 : _a.name) === 'ArrayBuffer';\\n    }\\n    _pick(obj, keys) {\\n        if (!obj || typeof obj !== 'object') {\\n            return {};\\n        }\\n        return Object.fromEntries(Object.entries(obj).filter(([key]) => keys.includes(key)));\\n    }\\n}\\nexports.default = Serializer;\\n//# sourceMappingURL=serializer.js.map\\n};\"],\n\"names\":[\"shadow$provide\",\"require\",\"module\",\"exports\",\"Object\",\"defineProperty\",\"value\",\"Serializer\",\"constructor\",\"allowedMetadataKeys\",\"HEADER_LENGTH\",\"USER_BROADCAST_PUSH_META_LENGTH\",\"KINDS\",\"userBroadcastPush\",\"userBroadcast\",\"BINARY_ENCODING\",\"JSON_ENCODING\",\"BROADCAST_EVENT\",\"encode\",\"msg\",\"callback\",\"event\",\"payload\",\"ArrayBuffer\",\"JSON\",\"stringify\",\"join_ref\",\"ref\",\"topic\",\"_binaryEncodeUserBroadcastPush\",\"message\",\"_a\",\"_isArrayBuffer\",\"_encodeBinaryUserBroadcastPush\",\"_encodeJsonUserBroadcastPush\",\"_b\",\"userPayload\",\"_encodeUserBroadcastPush\",\"encodedUserPayload\",\"encoder\",\"TextEncoder\",\"buffer\",\"encodingType\",\"encodedPayload\",\"joinRef\",\"userEvent\",\"rest\",\"_pick\",\"metadata\",\"keys\",\"length\",\"Error\",\"header\",\"view\",\"DataView\",\"offset\",\"setUint8\",\"Array\",\"from\",\"char\",\"charCodeAt\",\"combined\",\"Uint8Array\",\"byteLength\",\"set\",\"decode\",\"rawPayload\",\"result\",\"_binaryDecode\",\"jsonPayload\",\"parse\",\"kind\",\"getUint8\",\"decoder\",\"TextDecoder\",\"_decodeUserBroadcast\",\"topicSize\",\"userEventSize\",\"metadataSize\",\"payloadEncoding\",\"slice\",\"parsedPayload\",\"data\",\"type\",\"name\",\"obj\",\"fromEntries\",\"entries\",\"filter\",\"key\",\"includes\",\"default\"]\n}\n"]